import { CheckContext } from '/snippets/check-context.mdx';

Checks are best created using the [defineCheck](/reference/define-check) utility and are passed to the `checks` property in you [project's configuration](/reference/project-configuration). This function will
provide type-safety and intellisense for properties.

---

## Properties

### `message`

**Required**

A string that used the default title for the check in the CLI and Commonality Studio.



### `validate`

**Required**

The returned value of `validate` will determine the status of the check.

The `validate` function will be run against all packages matching a [selector](/selectors).

This function can be asynchronous.

#### Parameters

<CheckContext/>

#### Returns
`validate` can return any value, however, the check will only be valid if the function returns `true`. Any other returned value will set the status of the check to either `warn` or `fail` based on the configured [level](#level).

<Tabs>
<Tab title="TypeScript">
```ts
import type { Check } from 'commonality';

export default {
  message: 'Package has a CODEOWNER',
  validate: (ctx) => Boolean(ctx.codeowners.length),
} satisfies Check;
```
</Tab>
<Tab title="JavaScript">
```js
export default {
  message: 'Package has a CODEOWNER',
  validate: (ctx) => Boolean(ctx.codeowners.length),
};
```
</Tab>
</Tabs>

Returning a [message object]() allows you to modify the default message and provide additional context about the status of the check.

<Tabs>
<Tab title="TypeScript">
```ts
import type { Check } from 'commonality';
import { json, diff } from 'commonality';

export default {
  message: 'Package has internal config',
  validate: (ctx) => {
    // ...validation logic

    if (fileExists) {
      return {
        // This message will override the default message
        message: 'File "internal-config.json" does not exist',
        // This path will be shown directly underneath the message for quicker debugging
        path: ctx.package.path,
        // This will be shown as a suggestion for how to fix the issue
        suggestion: diff(source, expected)
      };
    }
  },
} satisfies Check;
```
</Tab>
<Tab title="JavaScript">
```ts
import { json, diff } from 'commonality';

export default {
  message: 'Package has internal config',
  validate: (ctx) => {
    // ...validation logic

    if (fileExists) {
      return {
        // This message will override the default message
        message: 'File "internal-config.json" does not exist',
        // This path will be shown directly underneath the message for quicker debugging
        path: ctx.package.path,
        // This will be shown as a suggestion for how to fix the issue
        suggestion: diff(source, expected)
      };
    }
  },
}
```
</Tab>
</Tabs>


### `fix`

A check's `fix` function will only run on packages that where the check's [validate](#validate) function has returned a falsey value. This function should update packages so that they pass the check's [validate](#validate) function.

This function can be asynchronous.

<Tip> We provide helper utilities like [json](/reference/json) and [text](/reference/text) to make it easier to read and write to files in [fix](/reference/check-object#fix) functions.</Tip>

#### Parameters

<CheckContext />


<Tabs>
<Tab title="TypeScript">
```ts
import type { Check } from 'commonality';
import { json } from 'commonality';

export default {
  return {
    //...
    fix: async (ctx) => {
      const tsConfig = await json(ctx.package.path, 'tsconfig.json').get();

      if (!tsConfig) {
        return;
      }

      await tsConfig.merge({ extends: base });
    },
  };
} satisfies Check;
```
</Tab>
<Tab title="JavaScript">
```ts
import { json } from 'commonality';

export default {
  return {
    //...
    fix: async (ctx) => {
      const tsConfig = await json(ctx.package.path, 'tsconfig.json').get();

      if (!tsConfig) {
        return;
      }

      await tsConfig.merge({ extends: base });
    },
  };
};
```
</Tab>
</Tabs>






### `level`

If set to `"error"`, the CLI will exit with a non-zero exit code if this check is ever invalid. Default is `"warning"`.
